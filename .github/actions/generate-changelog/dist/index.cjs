"use strict";var li=Object.create;var Ce=Object.defineProperty;var fi=Object.getOwnPropertyDescriptor;var pi=Object.getOwnPropertyNames;var hi=Object.getPrototypeOf,mi=Object.prototype.hasOwnProperty;var W=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),di=(e,t)=>{for(var r in t)Ce(e,r,{get:t[r],enumerable:!0})},Qt=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of pi(t))!mi.call(e,s)&&s!==r&&Ce(e,s,{get:()=>t[s],enumerable:!(n=fi(t,s))||n.enumerable});return e};var xe=(e,t,r)=>(r=e!=null?li(hi(e)):{},Qt(t||!e||!e.__esModule?Ce(r,"default",{value:e,enumerable:!0}):r,e)),gi=e=>Qt(Ce({},"__esModule",{value:!0}),e);var Yt=W((Uu,Xt)=>{var re=1e3,ne=re*60,se=ne*60,X=se*24,vi=X*7,_i=X*365.25;Xt.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0)return yi(e);if(r==="number"&&isFinite(e))return t.long?ki(e):bi(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function yi(e){if(e=String(e),!(e.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!!t){var r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*_i;case"weeks":case"week":case"w":return r*vi;case"days":case"day":case"d":return r*X;case"hours":case"hour":case"hrs":case"hr":case"h":return r*se;case"minutes":case"minute":case"mins":case"min":case"m":return r*ne;case"seconds":case"second":case"secs":case"sec":case"s":return r*re;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function bi(e){var t=Math.abs(e);return t>=X?Math.round(e/X)+"d":t>=se?Math.round(e/se)+"h":t>=ne?Math.round(e/ne)+"m":t>=re?Math.round(e/re)+"s":e+"ms"}function ki(e){var t=Math.abs(e);return t>=X?Se(e,t,X,"day"):t>=se?Se(e,t,se,"hour"):t>=ne?Se(e,t,ne,"minute"):t>=re?Se(e,t,re,"second"):e+" ms"}function Se(e,t,r,n){var s=t>=r*1.5;return Math.round(e/r)+" "+n+(s?"s":"")}});var Je=W((qu,Jt)=>{function Ti(e){r.debug=r,r.default=r,r.coerce=g,r.disable=i,r.enable=s,r.enabled=u,r.humanize=Yt(),r.destroy=v,Object.keys(e).forEach(l=>{r[l]=e[l]}),r.names=[],r.skips=[],r.formatters={};function t(l){let f=0;for(let m=0;m<l.length;m++)f=(f<<5)-f+l.charCodeAt(m),f|=0;return r.colors[Math.abs(f)%r.colors.length]}r.selectColor=t;function r(l){let f,m=null,h,G;function I(...A){if(!I.enabled)return;let q=I,ee=Number(new Date),Ke=ee-(f||ee);q.diff=Ke,q.prev=f,q.curr=ee,f=ee,A[0]=r.coerce(A[0]),typeof A[0]!="string"&&A.unshift("%O");let te=0;A[0]=A[0].replace(/%([a-zA-Z%])/g,(le,Qe)=>{if(le==="%%")return"%";te++;let we=r.formatters[Qe];if(typeof we=="function"){let Xe=A[te];le=we.call(q,Xe),A.splice(te,1),te--}return le}),r.formatArgs.call(q,A),(q.log||r.log).apply(q,A)}return I.namespace=l,I.useColors=r.useColors(),I.color=r.selectColor(l),I.extend=n,I.destroy=r.destroy,Object.defineProperty(I,"enabled",{enumerable:!0,configurable:!1,get:()=>m!==null?m:(h!==r.namespaces&&(h=r.namespaces,G=r.enabled(l)),G),set:A=>{m=A}}),typeof r.init=="function"&&r.init(I),I}function n(l,f){let m=r(this.namespace+(typeof f>"u"?":":f)+l);return m.log=this.log,m}function s(l){r.save(l),r.namespaces=l,r.names=[],r.skips=[];let f,m=(typeof l=="string"?l:"").split(/[\s,]+/),h=m.length;for(f=0;f<h;f++)!m[f]||(l=m[f].replace(/\*/g,".*?"),l[0]==="-"?r.skips.push(new RegExp("^"+l.slice(1)+"$")):r.names.push(new RegExp("^"+l+"$")))}function i(){let l=[...r.names.map(a),...r.skips.map(a).map(f=>"-"+f)].join(",");return r.enable(""),l}function u(l){if(l[l.length-1]==="*")return!0;let f,m;for(f=0,m=r.skips.length;f<m;f++)if(r.skips[f].test(l))return!1;for(f=0,m=r.names.length;f<m;f++)if(r.names[f].test(l))return!0;return!1}function a(l){return l.toString().substring(2,l.toString().length-2).replace(/\.\*\?$/,"*")}function g(l){return l instanceof Error?l.stack||l.message:l}function v(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}Jt.exports=Ti});var Zt=W((P,Oe)=>{P.formatArgs=Ci;P.save=xi;P.load=Si;P.useColors=wi;P.storage=Oi();P.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();P.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function wi(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Ci(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+Oe.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;e.splice(1,0,t,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,s=>{s!=="%%"&&(r++,s==="%c"&&(n=r))}),e.splice(n,0,t)}P.log=console.debug||console.log||(()=>{});function xi(e){try{e?P.storage.setItem("debug",e):P.storage.removeItem("debug")}catch{}}function Si(){let e;try{e=P.storage.getItem("debug")}catch{}return!e&&typeof process<"u"&&"env"in process&&(e=process.env.DEBUG),e}function Oi(){try{return localStorage}catch{}}Oe.exports=Je()(P);var{formatters:Ei}=Oe.exports;Ei.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var tr=W((S,Re)=>{var Ri=require("tty"),Ee=require("util");S.init=Ii;S.log=Mi;S.formatArgs=Fi;S.save=Li;S.load=Di;S.useColors=Ai;S.destroy=Ee.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");S.colors=[6,2,3,4,5,1];try{let e=require("supports-color");e&&(e.stderr||e).level>=2&&(S.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}S.inspectOpts=Object.keys(process.env).filter(e=>/^debug_/i.test(e)).reduce((e,t)=>{let r=t.substring(6).toLowerCase().replace(/_([a-z])/g,(s,i)=>i.toUpperCase()),n=process.env[t];return/^(yes|on|true|enabled)$/i.test(n)?n=!0:/^(no|off|false|disabled)$/i.test(n)?n=!1:n==="null"?n=null:n=Number(n),e[r]=n,e},{});function Ai(){return"colors"in S.inspectOpts?Boolean(S.inspectOpts.colors):Ri.isatty(process.stderr.fd)}function Fi(e){let{namespace:t,useColors:r}=this;if(r){let n=this.color,s="\x1B[3"+(n<8?n:"8;5;"+n),i=`  ${s};1m${t} \x1B[0m`;e[0]=i+e[0].split(`
`).join(`
`+i),e.push(s+"m+"+Re.exports.humanize(this.diff)+"\x1B[0m")}else e[0]=Pi()+t+" "+e[0]}function Pi(){return S.inspectOpts.hideDate?"":new Date().toISOString()+" "}function Mi(...e){return process.stderr.write(Ee.format(...e)+`
`)}function Li(e){e?process.env.DEBUG=e:delete process.env.DEBUG}function Di(){return process.env.DEBUG}function Ii(e){e.inspectOpts={};let t=Object.keys(S.inspectOpts);for(let r=0;r<t.length;r++)e.inspectOpts[t[r]]=S.inspectOpts[t[r]]}Re.exports=Je()(S);var{formatters:er}=Re.exports;er.o=function(e){return this.inspectOpts.colors=this.useColors,Ee.inspect(e,this.inspectOpts).split(`
`).map(t=>t.trim()).join(" ")};er.O=function(e){return this.inspectOpts.colors=this.useColors,Ee.inspect(e,this.inspectOpts)}});var et=W((Hu,Ze)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?Ze.exports=Zt():Ze.exports=tr()});var rr=W(M=>{"use strict";var $i=M&&M.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(M,"__esModule",{value:!0});var ji=require("fs"),Ni=$i(et()),ie=Ni.default("@kwsites/file-exists");function Bi(e,t,r){ie("checking %s",e);try{let n=ji.statSync(e);return n.isFile()&&t?(ie("[OK] path represents a file"),!0):n.isDirectory()&&r?(ie("[OK] path represents a directory"),!0):(ie("[FAIL] path represents something other than a file or directory"),!1)}catch(n){if(n.code==="ENOENT")return ie("[FAIL] path is not accessible: %o",n),!1;throw ie("[FATAL] %o",n),n}}function Gi(e,t=M.READABLE){return Bi(e,(t&M.FILE)>0,(t&M.FOLDER)>0)}M.exists=Gi;M.FILE=1;M.FOLDER=2;M.READABLE=M.FILE+M.FOLDER});var nr=W(Ae=>{"use strict";function Ui(e){for(var t in e)Ae.hasOwnProperty(t)||(Ae[t]=e[t])}Object.defineProperty(Ae,"__esModule",{value:!0});Ui(rr())});var rt=W(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.createDeferred=Y.deferred=void 0;function tt(){let e,t,r="pending";return{promise:new Promise((s,i)=>{e=s,t=i}),done(s){r==="pending"&&(r="resolved",e(s))},fail(s){r==="pending"&&(r="rejected",t(s))},get fulfilled(){return r!=="pending"},get status(){return r}}}Y.deferred=tt;Y.createDeferred=tt;Y.default=tt});var Nu={};di(Nu,{generateChangelog:()=>Du});module.exports=gi(Nu);var Ge=xe(nr(),1),je=xe(et(),1),wn=require("child_process"),cs=xe(rt(),1),ae=xe(rt(),1),Be=Object.defineProperty,qi=Object.defineProperties,Hi=Object.getOwnPropertyDescriptor,zi=Object.getOwnPropertyDescriptors,bt=Object.getOwnPropertyNames,sr=Object.getOwnPropertySymbols,Lr=Object.prototype.hasOwnProperty,Wi=Object.prototype.propertyIsEnumerable,ir=(e,t,r)=>t in e?Be(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,j=(e,t)=>{for(var r in t||(t={}))Lr.call(t,r)&&ir(e,r,t[r]);if(sr)for(var r of sr(t))Wi.call(t,r)&&ir(e,r,t[r]);return e},he=(e,t)=>qi(e,zi(t)),Vi=e=>Be(e,"__esModule",{value:!0}),c=(e,t)=>function(){return e&&(t=(0,e[bt(e)[0]])(e=0)),t},Ki=(e,t)=>function(){return t||(0,e[bt(e)[0]])((t={exports:{}}).exports,t),t.exports},C=(e,t)=>{for(var r in t)Be(e,r,{get:t[r],enumerable:!0})},Qi=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of bt(t))!Lr.call(e,s)&&(r||s!=="default")&&Be(e,s,{get:()=>t[s],enumerable:!(n=Hi(t,s))||n.enumerable});return e},w=(e=>(t,r)=>e&&e.get(t)||(r=Qi(Vi({}),t,1),e&&e.set(t,r),r))(typeof WeakMap<"u"?new WeakMap:0),pe=(e,t,r)=>new Promise((n,s)=>{var i=g=>{try{a(r.next(g))}catch(v){s(v)}},u=g=>{try{a(r.throw(g))}catch(v){s(v)}},a=g=>g.done?n(g.value):Promise.resolve(g.value).then(i,u);a((r=r.apply(e,t)).next())}),z,Q=c({"src/lib/errors/git-error.ts"(){z=class extends Error{constructor(e,t){super(t),this.task=e,Object.setPrototypeOf(this,new.target.prototype)}}}}),ve,ce=c({"src/lib/errors/git-response-error.ts"(){Q(),ve=class extends z{constructor(e,t){super(void 0,t||String(e)),this.git=e}}}}),Dr,Ir=c({"src/lib/errors/task-configuration-error.ts"(){Q(),Dr=class extends z{constructor(e){super(void 0,e)}}}});function $r(e){return typeof e=="function"?e:Z}function jr(e){return typeof e=="function"&&e!==Z}function Nr(e,t){let r=e.indexOf(t);return r<=0?[e,""]:[e.substr(0,r),e.substr(r+1)]}function Br(e,t=0){return Gr(e)&&e.length>t?e[t]:void 0}function J(e,t=0){if(Gr(e)&&e.length>t)return e[e.length-1-t]}function Gr(e){return!!(e&&typeof e.length=="number")}function _e(e="",t=!0,r=`
`){return e.split(r).reduce((n,s)=>{let i=t?s.trim():s;return i&&n.push(i),n},[])}function kt(e,t){return _e(e,!0).map(r=>t(r))}function Tt(e){return(0,Ge.exists)(e,Ge.FOLDER)}function b(e,t){return Array.isArray(e)?e.includes(t)||e.push(t):e.add(t),t}function Ur(e,t){return Array.isArray(e)&&!e.includes(t)&&e.push(t),e}function wt(e,t){if(Array.isArray(e)){let r=e.indexOf(t);r>=0&&e.splice(r,1)}else e.delete(t);return t}function K(e){return Array.isArray(e)?e:[e]}function qr(e){return K(e).map(String)}function T(e,t=0){if(e==null)return t;let r=parseInt(e,10);return isNaN(r)?t:r}function me(e,t){let r=[];for(let n=0,s=e.length;n<s;n++)r.push(t,e[n]);return r}function de(e){return(Array.isArray(e)?Buffer.concat(e):e).toString("utf-8")}function Hr(e,t){return Object.assign({},...t.map(r=>r in e?{[r]:e[r]}:{}))}function at(e=0){return new Promise(t=>setTimeout(t,e))}var ue,Z,ye,Ue=c({"src/lib/utils/util.ts"(){ue="\0",Z=()=>{},ye=Object.prototype.toString.call.bind(Object.prototype.toString)}});function U(e,t,r){return t(e)?e:arguments.length>2?r:void 0}function Ct(e,t){return/number|string|boolean/.test(typeof e)&&(!t||!t.includes(typeof e))}function xt(e){return!!e&&ye(e)==="[object Object]"}function zr(e){return typeof e=="function"}var be,E,Wr,$e,St,Vr=c({"src/lib/utils/argument-filters.ts"(){Ue(),be=e=>Array.isArray(e),E=e=>typeof e=="string",Wr=e=>Array.isArray(e)&&e.every(E),$e=e=>E(e)||Array.isArray(e)&&e.every(E),St=e=>e==null||"number|boolean|function".includes(typeof e)?!1:Array.isArray(e)||typeof e=="string"||typeof e.length=="number"}}),ut,Xi=c({"src/lib/utils/exit-codes.ts"(){ut=(e=>(e[e.SUCCESS=0]="SUCCESS",e[e.ERROR=1]="ERROR",e[e.NOT_FOUND=-2]="NOT_FOUND",e[e.UNCLEAN=128]="UNCLEAN",e))(ut||{})}}),ge,Yi=c({"src/lib/utils/git-output-streams.ts"(){ge=class{constructor(e,t){this.stdOut=e,this.stdErr=t}asStrings(){return new ge(this.stdOut.toString("utf8"),this.stdErr.toString("utf8"))}}}}),_,V,Ji=c({"src/lib/utils/line-parser.ts"(){_=class{constructor(e,t){this.matches=[],this.parse=(r,n)=>(this.resetMatches(),this._regExp.every((s,i)=>this.addMatch(s,i,r(i)))?this.useMatches(n,this.prepareMatches())!==!1:!1),this._regExp=Array.isArray(e)?e:[e],t&&(this.useMatches=t)}useMatches(e,t){throw new Error("LineParser:useMatches not implemented")}resetMatches(){this.matches.length=0}prepareMatches(){return this.matches}addMatch(e,t,r){let n=r&&e.exec(r);return n&&this.pushMatch(t,n),!!n}pushMatch(e,t){this.matches.push(...t.slice(1))}},V=class extends _{addMatch(e,t,r){return/^remote:\s/.test(String(r))&&super.addMatch(e,t,r)}pushMatch(e,t){(e>0||t.length>1)&&super.pushMatch(e,t)}}}});function Kr(...e){let t=process.cwd(),r=Object.assign(j({baseDir:t},Qr),...e.filter(n=>typeof n=="object"&&n));return r.baseDir=r.baseDir||t,r.trimmed=r.trimmed===!0,r}var Qr,Zi=c({"src/lib/utils/simple-git-options.ts"(){Qr={binary:"git",maxConcurrentProcesses:5,config:[],trimmed:!1}}});function Ot(e,t=[]){return xt(e)?Object.keys(e).reduce((r,n)=>{let s=e[n];return Ct(s,["boolean"])?r.push(n+"="+s):r.push(n),r},t):t}function H(e,t=0,r=!1){let n=[];for(let s=0,i=t<0?e.length:t;s<i;s++)"string|number".includes(typeof e[s])&&n.push(String(e[s]));return Ot(Et(e),n),r||n.push(...eo(e)),n}function eo(e){let t=typeof J(e)=="function";return U(J(e,t?1:0),be,[])}function Et(e){let t=zr(J(e));return U(J(e,t?1:0),xt)}function O(e,t=!0){let r=$r(J(e));return t||jr(r)?r:void 0}var to=c({"src/lib/utils/task-options.ts"(){Vr(),Ue()}});function ct(e,t){return e(t.stdOut,t.stdErr)}function D(e,t,r,n=!0){return K(r).forEach(s=>{for(let i=_e(s,n),u=0,a=i.length;u<a;u++){let g=(v=0)=>{if(!(u+v>=a))return i[u+v]};t.some(({parse:v})=>v(g,e))}}),e}var ro=c({"src/lib/utils/task-parser.ts"(){Ue()}}),Xr={};C(Xr,{ExitCodes:()=>ut,GitOutputStreams:()=>ge,LineParser:()=>_,NOOP:()=>Z,NULL:()=>ue,RemoteLineParser:()=>V,append:()=>b,appendTaskOptions:()=>Ot,asArray:()=>K,asFunction:()=>$r,asNumber:()=>T,asStringArray:()=>qr,bufferToString:()=>de,callTaskParser:()=>ct,createInstanceConfig:()=>Kr,delay:()=>at,filterArray:()=>be,filterFunction:()=>zr,filterHasLength:()=>St,filterPlainObject:()=>xt,filterPrimitives:()=>Ct,filterString:()=>E,filterStringArray:()=>Wr,filterStringOrStringArray:()=>$e,filterType:()=>U,first:()=>Br,folderExists:()=>Tt,forEachLineWithContent:()=>kt,getTrailingOptions:()=>H,including:()=>Ur,isUserFunction:()=>jr,last:()=>J,objectToString:()=>ye,parseStringResponse:()=>D,pick:()=>Hr,prefixedArray:()=>me,remove:()=>wt,splitOn:()=>Nr,toLinesWithContent:()=>_e,trailingFunctionArgument:()=>O,trailingOptionsArgument:()=>Et});var y=c({"src/lib/utils/index.ts"(){Vr(),Xi(),Yi(),Ji(),Zi(),to(),ro(),Ue()}}),Yr={};C(Yr,{CheckRepoActions:()=>lt,checkIsBareRepoTask:()=>Zr,checkIsRepoRootTask:()=>Jr,checkIsRepoTask:()=>no});function no(e){switch(e){case"bare":return Zr();case"root":return Jr()}return{commands:["rev-parse","--is-inside-work-tree"],format:"utf-8",onError:qe,parser:Rt}}function Jr(){return{commands:["rev-parse","--git-dir"],format:"utf-8",onError:qe,parser(t){return/^\.(git)?$/.test(t.trim())}}}function Zr(){return{commands:["rev-parse","--is-bare-repository"],format:"utf-8",onError:qe,parser:Rt}}function so(e){return/(Not a git repository|Kein Git-Repository)/i.test(String(e))}var lt,qe,Rt,en=c({"src/lib/tasks/check-is-repo.ts"(){y(),lt=(e=>(e.BARE="bare",e.IN_TREE="tree",e.IS_REPO_ROOT="root",e))(lt||{}),qe=({exitCode:e},t,r,n)=>{if(e===128&&so(t))return r(Buffer.from("false"));n(t)},Rt=e=>e.trim()==="true"}});function io(e,t){let r=new tn(e),n=e?nn:rn;return _e(t).forEach(s=>{let i=s.replace(n,"");r.paths.push(i),(sn.test(i)?r.folders:r.files).push(i)}),r}var tn,rn,nn,sn,oo=c({"src/lib/responses/CleanSummary.ts"(){y(),tn=class{constructor(e){this.dryRun=e,this.paths=[],this.files=[],this.folders=[]}},rn=/^[a-z]+\s*/i,nn=/^[a-z]+\s+[a-z]+\s*/i,sn=/\/$/}}),ft={};C(ft,{EMPTY_COMMANDS:()=>He,adhocExecTask:()=>on,configurationErrorTask:()=>F,isBufferTask:()=>an,isEmptyTask:()=>un,straightThroughBufferTask:()=>ao,straightThroughStringTask:()=>N});function on(e){return{commands:He,format:"empty",parser:e}}function F(e){return{commands:He,format:"empty",parser(){throw typeof e=="string"?new Dr(e):e}}}function N(e,t=!1){return{commands:e,format:"utf-8",parser(r){return t?String(r).trim():r}}}function ao(e){return{commands:e,format:"buffer",parser(t){return t}}}function an(e){return e.format==="buffer"}function un(e){return e.format==="empty"||!e.commands.length}var He,x=c({"src/lib/tasks/task.ts"(){Ir(),He=[]}}),cn={};C(cn,{CONFIG_ERROR_INTERACTIVE_MODE:()=>At,CONFIG_ERROR_MODE_REQUIRED:()=>Ft,CONFIG_ERROR_UNKNOWN_OPTION:()=>Pt,CleanOptions:()=>Me,cleanTask:()=>ln,cleanWithOptionsTask:()=>uo,isCleanOptionsArray:()=>co});function uo(e,t){let{cleanMode:r,options:n,valid:s}=lo(e);return r?s.options?(n.push(...t),n.some(ho)?F(At):ln(r,n)):F(Pt+JSON.stringify(e)):F(Ft)}function ln(e,t){return{commands:["clean",`-${e}`,...t],format:"utf-8",parser(n){return io(e==="n",n)}}}function co(e){return Array.isArray(e)&&e.every(t=>Mt.has(t))}function lo(e){let t,r=[],n={cleanMode:!1,options:!0};return e.replace(/[^a-z]i/g,"").split("").forEach(s=>{fo(s)?(t=s,n.cleanMode=!0):n.options=n.options&&po(r[r.length]=`-${s}`)}),{cleanMode:t,options:r,valid:n}}function fo(e){return e==="f"||e==="n"}function po(e){return/^-[a-z]$/i.test(e)&&Mt.has(e.charAt(1))}function ho(e){return/^-[^\-]/.test(e)?e.indexOf("i")>0:e==="--interactive"}var At,Ft,Pt,Me,Mt,fn=c({"src/lib/tasks/clean.ts"(){oo(),y(),x(),At="Git clean interactive mode is not supported",Ft='Git clean mode parameter ("n" or "f") is required',Pt="Git clean unknown option found in: ",Me=(e=>(e.DRY_RUN="n",e.FORCE="f",e.IGNORED_INCLUDED="x",e.IGNORED_ONLY="X",e.EXCLUDING="e",e.QUIET="q",e.RECURSIVE="d",e))(Me||{}),Mt=new Set(["i",...qr(Object.values(Me))])}});function mo(e){let t=new hn;for(let r of pn(e))t.addValue(r.file,String(r.key),r.value);return t}function go(e,t){let r=null,n=[],s=new Map;for(let i of pn(e,t))i.key===t&&(n.push(r=i.value),s.has(i.file)||s.set(i.file,[]),s.get(i.file).push(r));return{key:t,paths:Array.from(s.keys()),scopes:s,value:r,values:n}}function vo(e){return e.replace(/^(file):/,"")}function*pn(e,t=null){let r=e.split("\0");for(let n=0,s=r.length-1;n<s;){let i=vo(r[n++]),u=r[n++],a=t;if(u.includes(`
`)){let g=Nr(u,`
`);a=g[0],u=g[1]}yield{file:i,key:a,value:u}}}var hn,_o=c({"src/lib/responses/ConfigList.ts"(){y(),hn=class{constructor(){this.files=[],this.values=Object.create(null)}get all(){return this._all||(this._all=this.files.reduce((e,t)=>Object.assign(e,this.values[t]),{})),this._all}addFile(e){if(!(e in this.values)){let t=J(this.files);this.values[e]=t?Object.create(this.values[t]):{},this.files.push(e)}return this.values[e]}addValue(e,t,r){let n=this.addFile(e);n.hasOwnProperty(t)?Array.isArray(n[t])?n[t].push(r):n[t]=[n[t],r]:n[t]=r,this._all=void 0}}}});function nt(e,t){return typeof e=="string"&&pt.hasOwnProperty(e)?e:t}function yo(e,t,r,n){let s=["config",`--${n}`];return r&&s.push("--add"),s.push(e,t),{commands:s,format:"utf-8",parser(i){return i}}}function bo(e,t){let r=["config","--null","--show-origin","--get-all",e];return t&&r.splice(1,0,`--${t}`),{commands:r,format:"utf-8",parser(n){return go(n,e)}}}function ko(e){let t=["config","--list","--show-origin","--null"];return e&&t.push(`--${e}`),{commands:t,format:"utf-8",parser(r){return mo(r)}}}function To(){return{addConfig(e,t,...r){return this._runTask(yo(e,t,r[0]===!0,nt(r[1],"local")),O(arguments))},getConfig(e,t){return this._runTask(bo(e,nt(t,void 0)),O(arguments))},listConfig(...e){return this._runTask(ko(nt(e[0],void 0)),O(arguments))}}}var pt,mn=c({"src/lib/tasks/config.ts"(){_o(),y(),pt=(e=>(e.system="system",e.global="global",e.local="local",e.worktree="worktree",e))(pt||{})}});function wo(...e){return new gn().param(...e)}function Co(e){let t=new Set,r={};return kt(e,n=>{let[s,i,u]=n.split(ue);t.add(s),(r[s]=r[s]||[]).push({line:T(i),path:s,preview:u})}),{paths:t,results:r}}function xo(){return{grep(e){let t=O(arguments),r=H(arguments);for(let s of dn)if(r.includes(s))return this._runTask(F(`git.grep: use of "${s}" is not supported.`),t);typeof e=="string"&&(e=wo().param(e));let n=["grep","--null","-n","--full-name",...r,...e];return this._runTask({commands:n,format:"utf-8",parser(s){return Co(s)}},t)}}}var dn,fe,or,gn,vn=c({"src/lib/tasks/grep.ts"(){y(),x(),dn=["-h"],fe=Symbol("grepQuery"),gn=class{constructor(){this[or]=[]}*[(or=fe,Symbol.iterator)](){for(let e of this[fe])yield e}and(...e){return e.length&&this[fe].push("--and","(",...me(e,"-e"),")"),this}param(...e){return this[fe].push(...me(e,"-e")),this}}}}),_n={};C(_n,{ResetMode:()=>Le,getResetMode:()=>Oo,resetTask:()=>So});function So(e,t){let r=["reset"];return yn(e)&&r.push(`--${e}`),r.push(...t),N(r)}function Oo(e){if(yn(e))return e;switch(typeof e){case"string":case"undefined":return"soft"}}function yn(e){return bn.includes(e)}var Le,bn,kn=c({"src/lib/tasks/reset.ts"(){x(),Le=(e=>(e.MIXED="mixed",e.SOFT="soft",e.HARD="hard",e.MERGE="merge",e.KEEP="keep",e))(Le||{}),bn=Array.from(Object.values(Le))}});function Eo(){return(0,je.default)("simple-git")}function ar(e,t,r){return!t||!String(t).replace(/\s*/,"")?r?(n,...s)=>{e(n,...s),r(n,...s)}:e:(n,...s)=>{e(`%s ${n}`,t,...s),r&&r(n,...s)}}function Ro(e,t,{namespace:r}){if(typeof e=="string")return e;let n=t&&t.namespace||"";return n.startsWith(r)?n.substr(r.length+1):n||r}function Lt(e,t,r,n=Eo()){let s=e&&`[${e}]`||"",i=[],u=typeof t=="string"?n.extend(t):t,a=Ro(U(t,E),u,n);return v(r);function g(l,f){return b(i,Lt(e,a.replace(/^[^:]+/,l),f,n))}function v(l){let f=l&&`[${l}]`||"",m=u&&ar(u,f)||Z,h=ar(n,`${s} ${f}`,m);return Object.assign(u?m:h,{label:e,sibling:g,info:h,step:v})}}var Tn=c({"src/lib/git-logger.ts"(){y(),je.default.formatters.L=e=>String(St(e)?e.length:"-"),je.default.formatters.B=e=>Buffer.isBuffer(e)?e.toString("utf8"):ye(e)}}),Fe,ht,Ao=c({"src/lib/runners/tasks-pending-queue.ts"(){Q(),Tn(),Fe=class{constructor(e="GitExecutor"){this.logLabel=e,this._queue=new Map}withProgress(e){return this._queue.get(e)}createProgress(e){let t=Fe.getName(e.commands[0]),r=Lt(this.logLabel,t);return{task:e,logger:r,name:t}}push(e){let t=this.createProgress(e);return t.logger("Adding task to the queue, commands = %o",e.commands),this._queue.set(e,t),t}fatal(e){for(let[t,{logger:r}]of Array.from(this._queue.entries()))t===e.task?(r.info("Failed %o",e),r("Fatal exception, any as-yet un-started tasks run through this executor will not be attempted")):r.info("A fatal exception occurred in a previous task, the queue has been purged: %o",e.message),this.complete(t);if(this._queue.size!==0)throw new Error(`Queue size should be zero after fatal: ${this._queue.size}`)}complete(e){this.withProgress(e)&&this._queue.delete(e)}attempt(e){let t=this.withProgress(e);if(!t)throw new z(void 0,"TasksPendingQueue: attempt called for an unknown task");return t.logger("Starting task"),t}static getName(e="empty"){return`task:${e}:${++Fe.counter}`}},ht=Fe,ht.counter=0}});function oe(e,t){return{method:Br(e.commands)||"",commands:t}}function Fo(e,t){return r=>{t("[ERROR] child process exception %o",r),e.push(Buffer.from(String(r.stack),"ascii"))}}function ur(e,t,r,n){return s=>{r("%s received %L bytes",t,s),n("%B",s),e.push(s)}}var mt,Po=c({"src/lib/runners/git-executor-chain.ts"(){Q(),x(),y(),Ao(),mt=class{constructor(e,t,r){this._executor=e,this._scheduler=t,this._plugins=r,this._chain=Promise.resolve(),this._queue=new ht}get binary(){return this._executor.binary}get cwd(){return this._cwd||this._executor.cwd}set cwd(e){this._cwd=e}get env(){return this._executor.env}get outputHandler(){return this._executor.outputHandler}chain(){return this}push(e){return this._queue.push(e),this._chain=this._chain.then(()=>this.attemptTask(e))}attemptTask(e){return pe(this,null,function*(){let t=yield this._scheduler.next(),r=()=>this._queue.complete(e);try{let{logger:n}=this._queue.attempt(e);return yield un(e)?this.attemptEmptyTask(e,n):this.attemptRemoteTask(e,n)}catch(n){throw this.onFatalException(e,n)}finally{r(),t()}})}onFatalException(e,t){let r=t instanceof z?Object.assign(t,{task:e}):new z(e,t&&String(t));return this._chain=Promise.resolve(),this._queue.fatal(r),r}attemptRemoteTask(e,t){return pe(this,null,function*(){let r=this._plugins.exec("spawn.args",[...e.commands],oe(e,e.commands)),n=yield this.gitResponse(e,this.binary,r,this.outputHandler,t.step("SPAWN")),s=yield this.handleTaskData(e,r,n,t.step("HANDLE"));return t("passing response to task's parser as a %s",e.format),an(e)?ct(e.parser,s):ct(e.parser,s.asStrings())})}attemptEmptyTask(e,t){return pe(this,null,function*(){return t("empty task bypassing child process to call to task's parser"),e.parser(this)})}handleTaskData(e,t,r,n){let{exitCode:s,rejection:i,stdOut:u,stdErr:a}=r;return new Promise((g,v)=>{n("Preparing to handle process response exitCode=%d stdOut=",s);let{error:l}=this._plugins.exec("task.error",{error:i},j(j({},oe(e,t)),r));if(l&&e.onError)return n.info("exitCode=%s handling with custom error handler"),e.onError(r,l,f=>{n.info("custom error handler treated as success"),n("custom error returned a %s",ye(f)),g(new ge(Array.isArray(f)?Buffer.concat(f):f,Buffer.concat(a)))},v);if(l)return n.info("handling as error: exitCode=%s stdErr=%s rejection=%o",s,a.length,i),v(l);n.info("retrieving task output complete"),g(new ge(Buffer.concat(u),Buffer.concat(a)))})}gitResponse(e,t,r,n,s){return pe(this,null,function*(){let i=s.sibling("output"),u=this._plugins.exec("spawn.options",{cwd:this.cwd,env:this.env,windowsHide:!0},oe(e,e.commands));return new Promise(a=>{let g=[],v=[];s.info("%s %o",t,r),s("%O",u);let l=this._beforeSpawn(e,r);if(l)return a({stdOut:g,stdErr:v,exitCode:9901,rejection:l});this._plugins.exec("spawn.before",void 0,he(j({},oe(e,r)),{kill(m){l=m||l}}));let f=(0,wn.spawn)(t,r,u);f.stdout.on("data",ur(g,"stdOut",s,i.step("stdOut"))),f.stderr.on("data",ur(v,"stdErr",s,i.step("stdErr"))),f.on("error",Fo(v,s)),n&&(s("Passing child process stdOut/stdErr to custom outputHandler"),n(t,f.stdout,f.stderr,[...r])),this._plugins.exec("spawn.after",void 0,he(j({},oe(e,r)),{spawned:f,close(m,h){a({stdOut:g,stdErr:v,exitCode:m,rejection:l||h})},kill(m){f.killed||(l=m,f.kill("SIGINT"))}}))})})}_beforeSpawn(e,t){let r;return this._plugins.exec("spawn.before",void 0,he(j({},oe(e,t)),{kill(n){r=n||r}})),r}}}}),Cn={};C(Cn,{GitExecutor:()=>xn});var xn,Mo=c({"src/lib/runners/git-executor.ts"(){Po(),xn=class{constructor(e="git",t,r,n){this.binary=e,this.cwd=t,this._scheduler=r,this._plugins=n,this._chain=new mt(this,this._scheduler,this._plugins)}chain(){return new mt(this,this._scheduler,this._plugins)}push(e){return this._chain.push(e)}}}});function Lo(e,t,r=Z){let n=i=>{r(null,i)},s=i=>{(i==null?void 0:i.task)===e&&r(i instanceof ve?Do(i):i,void 0)};t.then(n,s)}function Do(e){let t=n=>{console.warn(`simple-git deprecation notice: accessing GitResponseError.${n} should be GitResponseError.git.${n}, this will no longer be available in version 3`),t=Z};return Object.create(e,Object.getOwnPropertyNames(e.git).reduce(r,{}));function r(n,s){return s in e||(n[s]={enumerable:!1,configurable:!1,get(){return t(s),e.git[s]}}),n}}var Io=c({"src/lib/task-callback.ts"(){ce(),y()}});function cr(e,t){return on(r=>{if(!Tt(e))throw new Error(`Git.cwd: cannot change to non-directory "${e}"`);return(t||r).cwd=e})}var $o=c({"src/lib/tasks/change-working-directory.ts"(){y(),x()}});function jo(e){return D({author:null,branch:"",commit:"",root:!1,summary:{changes:0,insertions:0,deletions:0}},Sn,e)}var Sn,No=c({"src/lib/parsers/parse-commit.ts"(){y(),Sn=[new _(/^\[([^\s]+)( \([^)]+\))? ([^\]]+)/,(e,[t,r,n])=>{e.branch=t,e.commit=n,e.root=!!r}),new _(/\s*Author:\s(.+)/i,(e,[t])=>{let r=t.split("<"),n=r.pop();!n||!n.includes("@")||(e.author={email:n.substr(0,n.length-1),name:r.join("<").trim()})}),new _(/(\d+)[^,]*(?:,\s*(\d+)[^,]*)(?:,\s*(\d+))/g,(e,[t,r,n])=>{e.summary.changes=parseInt(t,10)||0,e.summary.insertions=parseInt(r,10)||0,e.summary.deletions=parseInt(n,10)||0}),new _(/^(\d+)[^,]*(?:,\s*(\d+)[^(]+\(([+-]))?/,(e,[t,r,n])=>{e.summary.changes=parseInt(t,10)||0;let s=parseInt(r,10)||0;n==="-"?e.summary.deletions=s:n==="+"&&(e.summary.insertions=s)})]}}),On={};C(On,{commitTask:()=>En,default:()=>Rn});function En(e,t,r){return{commands:["-c","core.abbrev=40","commit",...me(e,"-m"),...t,...r],format:"utf-8",parser:jo}}function Rn(){return{commit(t,...r){let n=O(arguments),s=e(t)||En(K(t),K(U(r[0],$e,[])),[...U(r[1],be,[]),...H(arguments,0,!0)]);return this._runTask(s,n)}};function e(t){return!$e(t)&&F("git.commit: requires the commit message to be supplied as a string/string[]")}}var An=c({"src/lib/tasks/commit.ts"(){No(),y(),x()}});function Bo(e,t){let r=["hash-object",e];return t&&r.push("-w"),N(r,!0)}var Go=c({"src/lib/tasks/hash-object.ts"(){x()}});function Uo(e,t,r){let n=String(r).trim(),s;if(s=Fn.exec(n))return new De(e,t,!1,s[1]);if(s=Pn.exec(n))return new De(e,t,!0,s[1]);let i="",u=n.split(" ");for(;u.length;)if(u.shift()==="in"){i=u.join(" ");break}return new De(e,t,/^re/i.test(n),i)}var De,Fn,Pn,qo=c({"src/lib/responses/InitSummary.ts"(){De=class{constructor(e,t,r,n){this.bare=e,this.path=t,this.existing=r,this.gitDir=n}},Fn=/^Init.+ repository in (.+)$/,Pn=/^Rein.+ in (.+)$/}});function Ho(e){return e.includes(Dt)}function zo(e=!1,t,r){let n=["init",...r];return e&&!Ho(n)&&n.splice(1,0,Dt),{commands:n,format:"utf-8",parser(s){return Uo(n.includes("--bare"),t,s)}}}var Dt,Wo=c({"src/lib/tasks/init.ts"(){qo(),Dt="--bare"}});function It(e){for(let t=0;t<e.length;t++){let r=$t.exec(e[t]);if(r)return`--${r[1]}`}return""}function Vo(e){return $t.test(e)}var $t,ke=c({"src/lib/args/log-format.ts"(){$t=/^--(stat|numstat|name-only|name-status)(=|$)/}}),Mn,Ko=c({"src/lib/responses/DiffSummary.ts"(){Mn=class{constructor(){this.changed=0,this.deletions=0,this.insertions=0,this.files=[]}}}});function Ln(e=""){let t=Dn[e];return r=>D(new Mn,t,r,!1)}var st,lr,fr,pr,Dn,In=c({"src/lib/parsers/parse-diff-summary.ts"(){ke(),Ko(),y(),st=[new _(/(.+)\s+\|\s+(\d+)(\s+[+\-]+)?$/,(e,[t,r,n=""])=>{e.files.push({file:t.trim(),changes:T(r),insertions:n.replace(/[^+]/g,"").length,deletions:n.replace(/[^-]/g,"").length,binary:!1})}),new _(/(.+) \|\s+Bin ([0-9.]+) -> ([0-9.]+) ([a-z]+)/,(e,[t,r,n])=>{e.files.push({file:t.trim(),before:T(r),after:T(n),binary:!0})}),new _(/(\d+) files? changed\s*((?:, \d+ [^,]+){0,2})/,(e,[t,r])=>{let n=/(\d+) i/.exec(r),s=/(\d+) d/.exec(r);e.changed=T(t),e.insertions=T(n==null?void 0:n[1]),e.deletions=T(s==null?void 0:s[1])})],lr=[new _(/(\d+)\t(\d+)\t(.+)$/,(e,[t,r,n])=>{let s=T(t),i=T(r);e.changed++,e.insertions+=s,e.deletions+=i,e.files.push({file:n,changes:s+i,insertions:s,deletions:i,binary:!1})}),new _(/-\t-\t(.+)$/,(e,[t])=>{e.changed++,e.files.push({file:t,after:0,before:0,binary:!0})})],fr=[new _(/(.+)$/,(e,[t])=>{e.changed++,e.files.push({file:t,changes:0,insertions:0,deletions:0,binary:!1})})],pr=[new _(/([ACDMRTUXB])\s*(.+)$/,(e,[t,r])=>{e.changed++,e.files.push({file:r,changes:0,insertions:0,deletions:0,binary:!1})})],Dn={[""]:st,["--stat"]:st,["--numstat"]:lr,["--name-status"]:pr,["--name-only"]:fr}}});function Qo(e,t){return t.reduce((r,n,s)=>(r[n]=e[s]||"",r),Object.create({diff:null}))}function $n(e=Bt,t=jn,r=""){let n=Ln(r);return function(s){let i=_e(s,!0,jt).map(function(u){let a=u.trim().split(Nt),g=Qo(a[0].trim().split(e),t);return a.length>1&&!!a[1].trim()&&(g.diff=n(a[1])),g});return{all:i,latest:i.length&&i[0]||null,total:i.length}}}var jt,Nt,Bt,jn,Nn=c({"src/lib/parsers/parse-list-log-summary.ts"(){y(),In(),ke(),jt="\xF2\xF2\xF2\xF2\xF2\xF2 ",Nt=" \xF2\xF2",Bt=" \xF2 ",jn=["hash","date","message","refs","author_name","author_email"]}}),Bn={};C(Bn,{diffSummaryTask:()=>Xo,validateLogFormatConfig:()=>ze});function Xo(e){let t=It(e),r=["diff"];return t===""&&(t="--stat",r.push("--stat=4096")),r.push(...e),ze(r)||{commands:r,format:"utf-8",parser:Ln(t)}}function ze(e){let t=e.filter(Vo);if(t.length>1)return F(`Summary flags are mutually exclusive - pick one of ${t.join(",")}`);if(t.length&&e.includes("-z"))return F(`Summary flag ${t} parsing is not compatible with null termination option '-z'`)}var Gt=c({"src/lib/tasks/diff.ts"(){ke(),In(),x()}});function Yo(e,t){let r=[],n=[];return Object.keys(e).forEach(s=>{r.push(s),n.push(String(e[s]))}),[r,n.join(t)]}function Jo(e){return Object.keys(e).reduce((t,r)=>(r in dt||(t[r]=e[r]),t),{})}function Gn(e={},t=[]){let r=U(e.splitter,E,Bt),n=!Ct(e.format)&&e.format?e.format:{hash:"%H",date:e.strictDate===!1?"%ai":"%aI",message:"%s",refs:"%D",body:e.multiLine?"%B":"%b",author_name:e.mailMap!==!1?"%aN":"%an",author_email:e.mailMap!==!1?"%aE":"%ae"},[s,i]=Yo(n,r),u=[],a=[`--pretty=format:${jt}${i}${Nt}`,...t],g=e.n||e["max-count"]||e.maxCount;if(g&&a.push(`--max-count=${g}`),e.from||e.to){let v=e.symmetric!==!1?"...":"..";u.push(`${e.from||""}${v}${e.to||""}`)}return E(e.file)&&u.push("--follow",e.file),Ot(Jo(e),a),{fields:s,splitter:r,commands:[...a,...u]}}function Zo(e,t,r){let n=$n(e,t,It(r));return{commands:["log",...r],format:"utf-8",parser:n}}function ea(){return{log(...r){let n=O(arguments),s=Gn(Et(arguments),U(arguments[0],be)),i=t(...r)||ze(s.commands)||e(s);return this._runTask(i,n)}};function e(r){return Zo(r.splitter,r.fields,r.commands)}function t(r,n){return E(r)&&E(n)&&F("git.log(string, string) should be replaced with git.log({ from: string, to: string })")}}var dt,Un=c({"src/lib/tasks/log.ts"(){ke(),Nn(),y(),x(),Gt(),dt=(e=>(e[e["--pretty"]=0]="--pretty",e[e["max-count"]=1]="max-count",e[e.maxCount=2]="maxCount",e[e.n=3]="n",e[e.file=4]="file",e[e.format=5]="format",e[e.from=6]="from",e[e.to=7]="to",e[e.splitter=8]="splitter",e[e.symmetric=9]="symmetric",e[e.mailMap=10]="mailMap",e[e.multiLine=11]="multiLine",e[e.strictDate=12]="strictDate",e))(dt||{})}}),Ie,qn,ta=c({"src/lib/responses/MergeSummary.ts"(){Ie=class{constructor(e,t=null,r){this.reason=e,this.file=t,this.meta=r}toString(){return`${this.file}:${this.reason}`}},qn=class{constructor(){this.conflicts=[],this.merges=[],this.result="success"}get failed(){return this.conflicts.length>0}get reason(){return this.result}toString(){return this.conflicts.length?`CONFLICTS: ${this.conflicts.join(", ")}`:"OK"}}}}),gt,Hn,ra=c({"src/lib/responses/PullSummary.ts"(){gt=class{constructor(){this.remoteMessages={all:[]},this.created=[],this.deleted=[],this.files=[],this.deletions={},this.insertions={},this.summary={changes:0,deletions:0,insertions:0}}},Hn=class{constructor(){this.remote="",this.hash={local:"",remote:""},this.branch={local:"",remote:""},this.message=""}toString(){return this.message}}}});function it(e){return e.objects=e.objects||{compressing:0,counting:0,enumerating:0,packReused:0,reused:{count:0,delta:0},total:{count:0,delta:0}}}function hr(e){let t=/^\s*(\d+)/.exec(e),r=/delta (\d+)/i.exec(e);return{count:T(t&&t[1]||"0"),delta:T(r&&r[1]||"0")}}var zn,na=c({"src/lib/parsers/parse-remote-objects.ts"(){y(),zn=[new V(/^remote:\s*(enumerating|counting|compressing) objects: (\d+),/i,(e,[t,r])=>{let n=t.toLowerCase(),s=it(e.remoteMessages);Object.assign(s,{[n]:T(r)})}),new V(/^remote:\s*(enumerating|counting|compressing) objects: \d+% \(\d+\/(\d+)\),/i,(e,[t,r])=>{let n=t.toLowerCase(),s=it(e.remoteMessages);Object.assign(s,{[n]:T(r)})}),new V(/total ([^,]+), reused ([^,]+), pack-reused (\d+)/i,(e,[t,r,n])=>{let s=it(e.remoteMessages);s.total=hr(t),s.reused=hr(r),s.packReused=T(n)})]}});function Wn(e,t){return D({remoteMessages:new Kn},Vn,t)}var Vn,Kn,Qn=c({"src/lib/parsers/parse-remote-messages.ts"(){y(),na(),Vn=[new V(/^remote:\s*(.+)$/,(e,[t])=>(e.remoteMessages.all.push(t.trim()),!1)),...zn,new V([/create a (?:pull|merge) request/i,/\s(https?:\/\/\S+)$/],(e,[t])=>{e.remoteMessages.pullRequestUrl=t}),new V([/found (\d+) vulnerabilities.+\(([^)]+)\)/i,/\s(https?:\/\/\S+)$/],(e,[t,r,n])=>{e.remoteMessages.vulnerabilities={count:T(t),summary:r,url:n}})],Kn=class{constructor(){this.all=[]}}}});function sa(e,t){let r=D(new Hn,Xn,[e,t]);return r.message&&r}var mr,dr,gr,vr,Xn,_r,Ut,Yn=c({"src/lib/parsers/parse-pull.ts"(){ra(),y(),Qn(),mr=/^\s*(.+?)\s+\|\s+\d+\s*(\+*)(-*)/,dr=/(\d+)\D+((\d+)\D+\(\+\))?(\D+(\d+)\D+\(-\))?/,gr=/^(create|delete) mode \d+ (.+)/,vr=[new _(mr,(e,[t,r,n])=>{e.files.push(t),r&&(e.insertions[t]=r.length),n&&(e.deletions[t]=n.length)}),new _(dr,(e,[t,,r,,n])=>r!==void 0||n!==void 0?(e.summary.changes=+t||0,e.summary.insertions=+r||0,e.summary.deletions=+n||0,!0):!1),new _(gr,(e,[t,r])=>{b(e.files,r),b(t==="create"?e.created:e.deleted,r)})],Xn=[new _(/^from\s(.+)$/i,(e,[t])=>void(e.remote=t)),new _(/^fatal:\s(.+)$/,(e,[t])=>void(e.message=t)),new _(/([a-z0-9]+)\.\.([a-z0-9]+)\s+(\S+)\s+->\s+(\S+)$/,(e,[t,r,n,s])=>{e.branch.local=n,e.hash.local=t,e.branch.remote=s,e.hash.remote=r})],_r=(e,t)=>D(new gt,vr,[e,t]),Ut=(e,t)=>Object.assign(new gt,_r(e,t),Wn(e,t))}}),yr,Jn,br,ia=c({"src/lib/parsers/parse-merge.ts"(){ta(),y(),Yn(),yr=[new _(/^Auto-merging\s+(.+)$/,(e,[t])=>{e.merges.push(t)}),new _(/^CONFLICT\s+\((.+)\): Merge conflict in (.+)$/,(e,[t,r])=>{e.conflicts.push(new Ie(t,r))}),new _(/^CONFLICT\s+\((.+\/delete)\): (.+) deleted in (.+) and/,(e,[t,r,n])=>{e.conflicts.push(new Ie(t,r,{deleteRef:n}))}),new _(/^CONFLICT\s+\((.+)\):/,(e,[t])=>{e.conflicts.push(new Ie(t,null))}),new _(/^Automatic merge failed;\s+(.+)$/,(e,[t])=>{e.result=t})],Jn=(e,t)=>Object.assign(br(e,t),Ut(e,t)),br=e=>D(new qn,yr,e)}});function kr(e){return e.length?{commands:["merge",...e],format:"utf-8",parser(t,r){let n=Jn(t,r);if(n.failed)throw new ve(n);return n}}:F("Git.merge requires at least one option")}var oa=c({"src/lib/tasks/merge.ts"(){ce(),ia(),x()}});function aa(e,t,r){let n=r.includes("deleted"),s=r.includes("tag")||/^refs\/tags/.test(e),i=!r.includes("new");return{deleted:n,tag:s,branch:!s,new:!i,alreadyUpdated:i,local:e,remote:t}}var Tr,Zn,wr,ua=c({"src/lib/parsers/parse-push.ts"(){y(),Qn(),Tr=[new _(/^Pushing to (.+)$/,(e,[t])=>{e.repo=t}),new _(/^updating local tracking ref '(.+)'/,(e,[t])=>{e.ref=he(j({},e.ref||{}),{local:t})}),new _(/^[*-=]\s+([^:]+):(\S+)\s+\[(.+)]$/,(e,[t,r,n])=>{e.pushed.push(aa(t,r,n))}),new _(/^Branch '([^']+)' set up to track remote branch '([^']+)' from '([^']+)'/,(e,[t,r,n])=>{e.branch=he(j({},e.branch||{}),{local:t,remote:r,remoteName:n})}),new _(/^([^:]+):(\S+)\s+([a-z0-9]+)\.\.([a-z0-9]+)$/,(e,[t,r,n,s])=>{e.update={head:{local:t,remote:r},hash:{from:n,to:s}}})],Zn=(e,t)=>{let r=wr(e,t),n=Wn(e,t);return j(j({},r),n)},wr=(e,t)=>D({pushed:[]},Tr,[e,t])}}),es={};C(es,{pushTagsTask:()=>ca,pushTask:()=>qt});function ca(e={},t){return b(t,"--tags"),qt(e,t)}function qt(e={},t){let r=["push",...t];return e.branch&&r.splice(1,0,e.branch),e.remote&&r.splice(1,0,e.remote),wt(r,"-v"),b(r,"--verbose"),b(r,"--porcelain"),{commands:r,format:"utf-8",parser:Zn}}var ts=c({"src/lib/tasks/push.ts"(){ua(),y()}}),Cr,rs,la=c({"src/lib/responses/FileStatusSummary.ts"(){Cr=/^(.+) -> (.+)$/,rs=class{constructor(e,t,r){if(this.path=e,this.index=t,this.working_dir=r,t+r==="R"){let n=Cr.exec(e)||[null,e,e];this.from=n[1]||"",this.path=n[2]||""}}}}});function xr(e){let[t,r]=e.split(ue);return{from:r||t,to:t}}function L(e,t,r){return[`${e}${t}`,r]}function ot(e,...t){return t.map(r=>L(e,r,(n,s)=>b(n.conflicted,s)))}function fa(e,t){let r=t.trim();switch(" "){case r.charAt(2):return n(r.charAt(0),r.charAt(1),r.substr(3));case r.charAt(1):return n(" ",r.charAt(0),r.substr(2));default:return}function n(s,i,u){let a=`${s}${i}`,g=ns.get(a);g&&g(e,u),a!=="##"&&a!=="!!"&&e.files.push(new rs(u.replace(/\0.+$/,""),s,i))}}var Sr,ns,ss,pa=c({"src/lib/responses/StatusSummary.ts"(){y(),la(),Sr=class{constructor(){this.not_added=[],this.conflicted=[],this.created=[],this.deleted=[],this.ignored=void 0,this.modified=[],this.renamed=[],this.files=[],this.staged=[],this.ahead=0,this.behind=0,this.current=null,this.tracking=null,this.detached=!1,this.isClean=()=>!this.files.length}},ns=new Map([L(" ","A",(e,t)=>b(e.created,t)),L(" ","D",(e,t)=>b(e.deleted,t)),L(" ","M",(e,t)=>b(e.modified,t)),L("A"," ",(e,t)=>b(e.created,t)&&b(e.staged,t)),L("A","M",(e,t)=>b(e.created,t)&&b(e.staged,t)&&b(e.modified,t)),L("D"," ",(e,t)=>b(e.deleted,t)&&b(e.staged,t)),L("M"," ",(e,t)=>b(e.modified,t)&&b(e.staged,t)),L("M","M",(e,t)=>b(e.modified,t)&&b(e.staged,t)),L("R"," ",(e,t)=>{b(e.renamed,xr(t))}),L("R","M",(e,t)=>{let r=xr(t);b(e.renamed,r),b(e.modified,r.to)}),L("!","!",(e,t)=>{b(e.ignored=e.ignored||[],t)}),L("?","?",(e,t)=>b(e.not_added,t)),...ot("A","A","U"),...ot("D","D","U"),...ot("U","A","D","U"),["##",(e,t)=>{let r=/ahead (\d+)/,n=/behind (\d+)/,s=/^(.+?(?=(?:\.{3}|\s|$)))/,i=/\.{3}(\S*)/,u=/\son\s([\S]+)$/,a;a=r.exec(t),e.ahead=a&&+a[1]||0,a=n.exec(t),e.behind=a&&+a[1]||0,a=s.exec(t),e.current=a&&a[1],a=i.exec(t),e.tracking=a&&a[1],a=u.exec(t),e.current=a&&a[1]||e.current,e.detached=/\(no branch\)/.test(t)}]]),ss=function(e){let t=e.split(ue),r=new Sr;for(let n=0,s=t.length;n<s;){let i=t[n++].trim();!i||(i.charAt(0)==="R"&&(i+=ue+(t[n++]||"")),fa(r,i))}return r}}});function ha(e){let t=["status","--porcelain","-b","-u","--null",...e.filter(r=>!is.includes(r))];return{format:"utf-8",commands:t,parser(r){return ss(r)}}}var is,ma=c({"src/lib/tasks/status.ts"(){pa(),is=["--null","-z"]}});function Ne(e=0,t=0,r=0,n="",s=!0){return Object.defineProperty({major:e,minor:t,patch:r,agent:n,installed:s},"toString",{value(){return`${this.major}.${this.minor}.${this.patch}`},configurable:!1,enumerable:!1})}function da(){return Ne(0,0,0,"",!1)}function ga(){return{version(){return this._runTask({commands:["--version"],format:"utf-8",parser:va,onError(e,t,r,n){if(e.exitCode===-2)return r(Buffer.from(Ht));n(t)}})}}}function va(e){return e===Ht?da():D(Ne(0,0,0,e),os,e)}var Ht,os,_a=c({"src/lib/tasks/version.ts"(){y(),Ht="installed=false",os=[new _(/version (\d+)\.(\d+)\.(\d+)(?:\s*\((.+)\))?/,(e,[t,r,n,s=""])=>{Object.assign(e,Ne(T(t),T(r),T(n),s))}),new _(/version (\d+)\.(\d+)\.(\D+)(.+)?$/,(e,[t,r,n,s=""])=>{Object.assign(e,Ne(T(t),T(r),n,s))})]}}),as={};C(as,{SimpleGitApi:()=>vt});var vt,ya=c({"src/lib/simple-git-api.ts"(){Io(),$o(),An(),mn(),vn(),Go(),Wo(),Un(),oa(),ts(),ma(),x(),_a(),y(),vt=class{constructor(e){this._executor=e}_runTask(e,t){let r=this._executor.chain(),n=r.push(e);return t&&Lo(e,n,t),Object.create(this,{then:{value:n.then.bind(n)},catch:{value:n.catch.bind(n)},_executor:{value:r}})}add(e){return this._runTask(N(["add",...K(e)]),O(arguments))}cwd(e){let t=O(arguments);return typeof e=="string"?this._runTask(cr(e,this._executor),t):typeof(e==null?void 0:e.path)=="string"?this._runTask(cr(e.path,e.root&&this._executor||void 0),t):this._runTask(F("Git.cwd: workingDirectory must be supplied as a string"),t)}hashObject(e,t){return this._runTask(Bo(e,t===!0),O(arguments))}init(e){return this._runTask(zo(e===!0,this._executor.cwd,H(arguments)),O(arguments))}merge(){return this._runTask(kr(H(arguments)),O(arguments))}mergeFromTo(e,t){return E(e)&&E(t)?this._runTask(kr([e,t,...H(arguments)]),O(arguments,!1)):this._runTask(F("Git.mergeFromTo requires that the 'remote' and 'branch' arguments are supplied as strings"))}outputHandler(e){return this._executor.outputHandler=e,this}push(){let e=qt({remote:U(arguments[0],E),branch:U(arguments[1],E)},H(arguments));return this._runTask(e,O(arguments))}stash(){return this._runTask(N(["stash",...H(arguments)]),O(arguments))}status(){return this._runTask(ha(H(arguments)),O(arguments))}},Object.assign(vt.prototype,Rn(),To(),xo(),ea(),ga())}}),us={};C(us,{Scheduler:()=>ls});var Or,ls,ba=c({"src/lib/runners/scheduler.ts"(){y(),Tn(),Or=(()=>{let e=0;return()=>{e++;let{promise:t,done:r}=(0,cs.createDeferred)();return{promise:t,done:r,id:e}}})(),ls=class{constructor(e=2){this.concurrency=e,this.logger=Lt("","scheduler"),this.pending=[],this.running=[],this.logger("Constructed, concurrency=%s",e)}schedule(){if(!this.pending.length||this.running.length>=this.concurrency){this.logger("Schedule attempt ignored, pending=%s running=%s concurrency=%s",this.pending.length,this.running.length,this.concurrency);return}let e=b(this.running,this.pending.shift());this.logger("Attempting id=%s",e.id),e.done(()=>{this.logger("Completing id=",e.id),wt(this.running,e),this.schedule()})}next(){let{promise:e,id:t}=b(this.pending,Or());return this.logger("Scheduling id=%s",t),this.schedule(),e}}}}),fs={};C(fs,{applyPatchTask:()=>ka});function ka(e,t){return N(["apply",...t,...e])}var Ta=c({"src/lib/tasks/apply-patch.ts"(){x()}});function wa(e,t){return{branch:e,hash:t,success:!0}}function Ca(e){return{branch:e,hash:null,success:!1}}var ps,xa=c({"src/lib/responses/BranchDeleteSummary.ts"(){ps=class{constructor(){this.all=[],this.branches={},this.errors=[]}get success(){return!this.errors.length}}}});function hs(e,t){return t===1&&_t.test(e)}var Er,_t,Rr,We,Sa=c({"src/lib/parsers/parse-branch-delete.ts"(){xa(),y(),Er=/(\S+)\s+\(\S+\s([^)]+)\)/,_t=/^error[^']+'([^']+)'/m,Rr=[new _(Er,(e,[t,r])=>{let n=wa(t,r);e.all.push(n),e.branches[t]=n}),new _(_t,(e,[t])=>{let r=Ca(t);e.errors.push(r),e.all.push(r),e.branches[t]=r})],We=(e,t)=>D(new ps,Rr,[e,t])}}),ms,Oa=c({"src/lib/responses/BranchSummary.ts"(){ms=class{constructor(){this.all=[],this.branches={},this.current="",this.detached=!1}push(e,t,r,n,s){e==="*"&&(this.detached=t,this.current=r),this.all.push(r),this.branches[r]={current:e==="*",linkedWorkTree:e==="+",name:r,commit:n,label:s}}}}});function Ar(e){return e?e.charAt(0):""}function ds(e){return D(new ms,gs,e)}var gs,Ea=c({"src/lib/parsers/parse-branch.ts"(){Oa(),y(),gs=[new _(/^([*+]\s)?\((?:HEAD )?detached (?:from|at) (\S+)\)\s+([a-z0-9]+)\s(.*)$/,(e,[t,r,n,s])=>{e.push(Ar(t),!0,r,n,s)}),new _(/^([*+]\s)?(\S+)\s+([a-z0-9]+)\s?(.*)$/s,(e,[t,r,n,s])=>{e.push(Ar(t),!1,r,n,s)})]}}),vs={};C(vs,{branchLocalTask:()=>Aa,branchTask:()=>Ra,containsDeleteBranchCommand:()=>_s,deleteBranchTask:()=>Pa,deleteBranchesTask:()=>Fa});function _s(e){let t=["-d","-D","--delete"];return e.some(r=>t.includes(r))}function Ra(e){let t=_s(e),r=["branch",...e];return r.length===1&&r.push("-a"),r.includes("-v")||r.splice(1,0,"-v"),{format:"utf-8",commands:r,parser(n,s){return t?We(n,s).all[0]:ds(n)}}}function Aa(){return{format:"utf-8",commands:["branch","-v"],parser:ds}}function Fa(e,t=!1){return{format:"utf-8",commands:["branch","-v",t?"-D":"-d",...e],parser(r,n){return We(r,n)},onError({exitCode:r,stdOut:n},s,i,u){if(!hs(String(s),r))return u(s);i(n)}}}function Pa(e,t=!1){let r={format:"utf-8",commands:["branch","-v",t?"-D":"-d",e],parser(n,s){return We(n,s).branches[e]},onError({exitCode:n,stdErr:s,stdOut:i},u,a,g){if(!hs(String(u),n))return g(u);throw new ve(r.parser(de(i),de(s)),String(u))}};return r}var Ma=c({"src/lib/tasks/branch.ts"(){ce(),Sa(),Ea(),y()}}),ys,La=c({"src/lib/responses/CheckIgnore.ts"(){ys=e=>e.split(/\n/g).map(t=>t.trim()).filter(t=>!!t)}}),bs={};C(bs,{checkIgnoreTask:()=>Da});function Da(e){return{commands:["check-ignore",...e],format:"utf-8",parser:ys}}var Ia=c({"src/lib/tasks/check-ignore.ts"(){La()}}),ks={};C(ks,{cloneMirrorTask:()=>ja,cloneTask:()=>Ts});function $a(e){return/^--upload-pack(=|$)/.test(e)}function Ts(e,t,r){let n=["clone",...r];return E(e)&&n.push(e),E(t)&&n.push(t),n.find($a)?F("git.fetch: potential exploit argument blocked."):N(n)}function ja(e,t,r){return b(r,"--mirror"),Ts(e,t,r)}var Na=c({"src/lib/tasks/clone.ts"(){x(),y()}});function Ba(e,t){return D({raw:e,remote:null,branches:[],tags:[],updated:[],deleted:[]},ws,[e,t])}var ws,Ga=c({"src/lib/parsers/parse-fetch.ts"(){y(),ws=[new _(/From (.+)$/,(e,[t])=>{e.remote=t}),new _(/\* \[new branch]\s+(\S+)\s*-> (.+)$/,(e,[t,r])=>{e.branches.push({name:t,tracking:r})}),new _(/\* \[new tag]\s+(\S+)\s*-> (.+)$/,(e,[t,r])=>{e.tags.push({name:t,tracking:r})}),new _(/- \[deleted]\s+\S+\s*-> (.+)$/,(e,[t])=>{e.deleted.push({tracking:t})}),new _(/\s*([^.]+)\.\.(\S+)\s+(\S+)\s*-> (.+)$/,(e,[t,r,n,s])=>{e.updated.push({name:n,tracking:s,to:r,from:t})})]}}),Cs={};C(Cs,{fetchTask:()=>qa});function Ua(e){return/^--upload-pack(=|$)/.test(e)}function qa(e,t,r){let n=["fetch",...r];return e&&t&&n.push(e,t),n.find(Ua)?F("git.fetch: potential exploit argument blocked."):{commands:n,format:"utf-8",parser:Ba}}var Ha=c({"src/lib/tasks/fetch.ts"(){Ga(),x()}});function za(e){return D({moves:[]},xs,e)}var xs,Wa=c({"src/lib/parsers/parse-move.ts"(){y(),xs=[new _(/^Renaming (.+) to (.+)$/,(e,[t,r])=>{e.moves.push({from:t,to:r})})]}}),Ss={};C(Ss,{moveTask:()=>Va});function Va(e,t){return{commands:["mv","-v",...K(e),t],format:"utf-8",parser:za}}var Ka=c({"src/lib/tasks/move.ts"(){Wa(),y()}}),Os={};C(Os,{pullTask:()=>Qa});function Qa(e,t,r){let n=["pull",...r];return e&&t&&n.splice(1,0,e,t),{commands:n,format:"utf-8",parser(s,i){return Ut(s,i)},onError(s,i,u,a){let g=sa(de(s.stdOut),de(s.stdErr));if(g)return a(new ve(g));a(i)}}}var Xa=c({"src/lib/tasks/pull.ts"(){ce(),Yn(),y()}});function Ya(e){let t={};return Es(e,([r])=>t[r]={name:r}),Object.values(t)}function Ja(e){let t={};return Es(e,([r,n,s])=>{t.hasOwnProperty(r)||(t[r]={name:r,refs:{fetch:"",push:""}}),s&&n&&(t[r].refs[s.replace(/[^a-z]/g,"")]=n)}),Object.values(t)}function Es(e,t){kt(e,r=>t(r.split(/\s+/)))}var Za=c({"src/lib/responses/GetRemoteSummary.ts"(){y()}}),Rs={};C(Rs,{addRemoteTask:()=>eu,getRemotesTask:()=>tu,listRemotesTask:()=>ru,remoteTask:()=>nu,removeRemoteTask:()=>su});function eu(e,t,r=[]){return N(["remote","add",...r,e,t])}function tu(e){let t=["remote"];return e&&t.push("-v"),{commands:t,format:"utf-8",parser:e?Ja:Ya}}function ru(e=[]){let t=[...e];return t[0]!=="ls-remote"&&t.unshift("ls-remote"),N(t)}function nu(e=[]){let t=[...e];return t[0]!=="remote"&&t.unshift("remote"),N(t)}function su(e){return N(["remote","remove",e])}var iu=c({"src/lib/tasks/remote.ts"(){Za(),x()}}),As={};C(As,{stashListTask:()=>ou});function ou(e={},t){let r=Gn(e),n=["stash","list",...r.commands,...t],s=$n(r.splitter,r.fields,It(n));return ze(n)||{commands:n,format:"utf-8",parser:s}}var au=c({"src/lib/tasks/stash-list.ts"(){ke(),Nn(),Gt(),Un()}}),Fs={};C(Fs,{addSubModuleTask:()=>uu,initSubModuleTask:()=>cu,subModuleTask:()=>Ve,updateSubModuleTask:()=>lu});function uu(e,t){return Ve(["add",e,t])}function cu(e){return Ve(["init",...e])}function Ve(e){let t=[...e];return t[0]!=="submodule"&&t.unshift("submodule"),N(t)}function lu(e){return Ve(["update",...e])}var fu=c({"src/lib/tasks/sub-module.ts"(){x()}});function pu(e,t){let r=isNaN(e),n=isNaN(t);return r!==n?r?1:-1:r?Ps(e,t):0}function Ps(e,t){return e===t?0:e>t?1:-1}function hu(e){return e.trim()}function Pe(e){return typeof e=="string"&&parseInt(e.replace(/^\D+/g,""),10)||0}var Fr,Ms,mu=c({"src/lib/responses/TagList.ts"(){Fr=class{constructor(e,t){this.all=e,this.latest=t}},Ms=function(e,t=!1){let r=e.split(`
`).map(hu).filter(Boolean);t||r.sort(function(s,i){let u=s.split("."),a=i.split(".");if(u.length===1||a.length===1)return pu(Pe(u[0]),Pe(a[0]));for(let g=0,v=Math.max(u.length,a.length);g<v;g++){let l=Ps(Pe(u[g]),Pe(a[g]));if(l)return l}return 0});let n=t?r[0]:[...r].reverse().find(s=>s.indexOf(".")>=0);return new Fr(r,n)}}}),Ls={};C(Ls,{addAnnotatedTagTask:()=>vu,addTagTask:()=>gu,tagListTask:()=>du});function du(e=[]){let t=e.some(r=>/^--sort=/.test(r));return{format:"utf-8",commands:["tag","-l",...e],parser(r){return Ms(r,t)}}}function gu(e){return{format:"utf-8",commands:["tag",e],parser(){return{name:e}}}}function vu(e,t){return{format:"utf-8",commands:["tag","-a","-m",t,e],parser(){return{name:e}}}}var _u=c({"src/lib/tasks/tag.ts"(){mu()}}),yu=Ki({"src/git.js"(e,t){var{GitExecutor:r}=(Mo(),w(Cn)),{SimpleGitApi:n}=(ya(),w(as)),{Scheduler:s}=(ba(),w(us)),{configurationErrorTask:i}=(x(),w(ft)),{asArray:u,filterArray:a,filterPrimitives:g,filterString:v,filterStringOrStringArray:l,filterType:f,getTrailingOptions:m,trailingFunctionArgument:h,trailingOptionsArgument:G}=(y(),w(Xr)),{applyPatchTask:I}=(Ta(),w(fs)),{branchTask:A,branchLocalTask:q,deleteBranchesTask:ee,deleteBranchTask:Ke}=(Ma(),w(vs)),{checkIgnoreTask:te}=(Ia(),w(bs)),{checkIsRepoTask:Vt}=(en(),w(Yr)),{cloneTask:le,cloneMirrorTask:Qe}=(Na(),w(ks)),{cleanWithOptionsTask:we,isCleanOptionsArray:Xe}=(fn(),w(cn)),{commitTask:Bu}=(An(),w(On)),{diffSummaryTask:qs}=(Gt(),w(Bn)),{fetchTask:Hs}=(Ha(),w(Cs)),{moveTask:zs}=(Ka(),w(Ss)),{pullTask:Ws}=(Xa(),w(Os)),{pushTagsTask:Vs}=(ts(),w(es)),{addRemoteTask:Ks,getRemotesTask:Qs,listRemotesTask:Xs,remoteTask:Ys,removeRemoteTask:Js}=(iu(),w(Rs)),{getResetMode:Zs,resetTask:ei}=(kn(),w(_n)),{stashListTask:ti}=(au(),w(As)),{addSubModuleTask:ri,initSubModuleTask:ni,subModuleTask:si,updateSubModuleTask:ii}=(fu(),w(Fs)),{addAnnotatedTagTask:oi,addTagTask:ai,tagListTask:ui}=(_u(),w(Ls)),{straightThroughBufferTask:ci,straightThroughStringTask:$}=(x(),w(ft));function d(o,p){this._executor=new r(o.binary,o.baseDir,new s(o.maxConcurrentProcesses),p),this._trimmed=o.trimmed}(d.prototype=Object.create(n.prototype)).constructor=d,d.prototype.customBinary=function(o){return this._executor.binary=o,this},d.prototype.env=function(o,p){return arguments.length===1&&typeof o=="object"?this._executor.env=o:(this._executor.env=this._executor.env||{})[o]=p,this},d.prototype.stashList=function(o){return this._runTask(ti(G(arguments)||{},a(o)&&o||[]),h(arguments))};function Kt(o,p,k,R){return typeof k!="string"?i(`git.${o}() requires a string 'repoPath'`):p(k,f(R,v),m(arguments))}d.prototype.clone=function(){return this._runTask(Kt("clone",le,...arguments),h(arguments))},d.prototype.mirror=function(){return this._runTask(Kt("mirror",Qe,...arguments),h(arguments))},d.prototype.mv=function(o,p){return this._runTask(zs(o,p),h(arguments))},d.prototype.checkoutLatestTag=function(o){var p=this;return this.pull(function(){p.tags(function(k,R){p.checkout(R.latest,o)})})},d.prototype.pull=function(o,p,k,R){return this._runTask(Ws(f(o,v),f(p,v),m(arguments)),h(arguments))},d.prototype.fetch=function(o,p){return this._runTask(Hs(f(o,v),f(p,v),m(arguments)),h(arguments))},d.prototype.silent=function(o){return console.warn("simple-git deprecation notice: git.silent: logging should be configured using the `debug` library / `DEBUG` environment variable, this will be an error in version 3"),this},d.prototype.tags=function(o,p){return this._runTask(ui(m(arguments)),h(arguments))},d.prototype.rebase=function(){return this._runTask($(["rebase",...m(arguments)]),h(arguments))},d.prototype.reset=function(o){return this._runTask(ei(Zs(o),m(arguments)),h(arguments))},d.prototype.revert=function(o){let p=h(arguments);return typeof o!="string"?this._runTask(i("Commit must be a string"),p):this._runTask($(["revert",...m(arguments,0,!0),o]),p)},d.prototype.addTag=function(o){let p=typeof o=="string"?ai(o):i("Git.addTag requires a tag name");return this._runTask(p,h(arguments))},d.prototype.addAnnotatedTag=function(o,p){return this._runTask(oi(o,p),h(arguments))},d.prototype.checkout=function(){let o=["checkout",...m(arguments,!0)];return this._runTask($(o),h(arguments))},d.prototype.checkoutBranch=function(o,p,k){return this.checkout(["-b",o,p],h(arguments))},d.prototype.checkoutLocalBranch=function(o,p){return this.checkout(["-b",o],h(arguments))},d.prototype.deleteLocalBranch=function(o,p,k){return this._runTask(Ke(o,typeof p=="boolean"?p:!1),h(arguments))},d.prototype.deleteLocalBranches=function(o,p,k){return this._runTask(ee(o,typeof p=="boolean"?p:!1),h(arguments))},d.prototype.branch=function(o,p){return this._runTask(A(m(arguments)),h(arguments))},d.prototype.branchLocal=function(o){return this._runTask(q(),h(arguments))},d.prototype.raw=function(o){let p=!Array.isArray(o),k=[].slice.call(p?arguments:o,0);for(let B=0;B<k.length&&p;B++)if(!g(k[B])){k.splice(B,k.length-B);break}k.push(...m(arguments,0,!0));var R=h(arguments);return k.length?this._runTask($(k,this._trimmed),R):this._runTask(i("Raw: must supply one or more command to execute"),R)},d.prototype.submoduleAdd=function(o,p,k){return this._runTask(ri(o,p),h(arguments))},d.prototype.submoduleUpdate=function(o,p){return this._runTask(ii(m(arguments,!0)),h(arguments))},d.prototype.submoduleInit=function(o,p){return this._runTask(ni(m(arguments,!0)),h(arguments))},d.prototype.subModule=function(o,p){return this._runTask(si(m(arguments)),h(arguments))},d.prototype.listRemote=function(){return this._runTask(Xs(m(arguments)),h(arguments))},d.prototype.addRemote=function(o,p,k){return this._runTask(Ks(o,p,m(arguments)),h(arguments))},d.prototype.removeRemote=function(o,p){return this._runTask(Js(o),h(arguments))},d.prototype.getRemotes=function(o,p){return this._runTask(Qs(o===!0),h(arguments))},d.prototype.remote=function(o,p){return this._runTask(Ys(m(arguments)),h(arguments))},d.prototype.tag=function(o,p){let k=m(arguments);return k[0]!=="tag"&&k.unshift("tag"),this._runTask($(k),h(arguments))},d.prototype.updateServerInfo=function(o){return this._runTask($(["update-server-info"]),h(arguments))},d.prototype.pushTags=function(o,p){let k=Vs({remote:f(o,v)},m(arguments));return this._runTask(k,h(arguments))},d.prototype.rm=function(o){return this._runTask($(["rm","-f",...u(o)]),h(arguments))},d.prototype.rmKeepLocal=function(o){return this._runTask($(["rm","--cached",...u(o)]),h(arguments))},d.prototype.catFile=function(o,p){return this._catFile("utf-8",arguments)},d.prototype.binaryCatFile=function(){return this._catFile("buffer",arguments)},d.prototype._catFile=function(o,p){var k=h(p),R=["cat-file"],B=p[0];if(typeof B=="string")return this._runTask(i("Git.catFile: options must be supplied as an array of strings"),k);Array.isArray(B)&&R.push.apply(R,B);let Ye=o==="buffer"?ci(R):$(R);return this._runTask(Ye,k)},d.prototype.diff=function(o,p){let k=v(o)?i("git.diff: supplying options as a single string is no longer supported, switch to an array of strings"):$(["diff",...m(arguments)]);return this._runTask(k,h(arguments))},d.prototype.diffSummary=function(){return this._runTask(qs(m(arguments,1)),h(arguments))},d.prototype.applyPatch=function(o){let p=l(o)?I(u(o),m([].slice.call(arguments,1))):i("git.applyPatch requires one or more string patches as the first argument");return this._runTask(p,h(arguments))},d.prototype.revparse=function(){let o=["rev-parse",...m(arguments,!0)];return this._runTask($(o,!0),h(arguments))},d.prototype.show=function(o,p){return this._runTask($(["show",...m(arguments,1)]),h(arguments))},d.prototype.clean=function(o,p,k){let R=Xe(o),B=R&&o.join("")||f(o,v)||"",Ye=m([].slice.call(arguments,R?1:0));return this._runTask(we(B,Ye),h(arguments))},d.prototype.exec=function(o){let p={commands:[],format:"utf-8",parser(){typeof o=="function"&&o()}};return this._runTask(p)},d.prototype.clearQueue=function(){return this},d.prototype.checkIgnore=function(o,p){return this._runTask(te(u(f(o,l,[]))),h(arguments))},d.prototype.checkIsRepo=function(o,p){return this._runTask(Vt(f(o,v)),h(arguments))},t.exports=d}});Q();var bu=class extends z{constructor(e,t){super(void 0,t),this.config=e}};Q();Q();var yt=class extends z{constructor(e,t,r){super(e,r),this.task=e,this.plugin=t,Object.setPrototypeOf(this,new.target.prototype)}};ce();Ir();en();fn();mn();vn();kn();function ku(e){return e?[{type:"spawn.before",action(n,s){e.aborted&&s.kill(new yt(void 0,"abort","Abort already signaled"))}},{type:"spawn.after",action(n,s){function i(){s.kill(new yt(void 0,"abort","Abort signal received"))}e.addEventListener("abort",i),s.spawned.on("close",()=>e.removeEventListener("abort",i))}}]:void 0}y();function Tu(e){let t=me(e,"-c");return{type:"spawn.args",action(r){return[...t,...r]}}}y();var Pr=(0,ae.deferred)().promise;function wu({onClose:e=!0,onExit:t=50}={}){function r(){let s=-1,i={close:(0,ae.deferred)(),closeTimeout:(0,ae.deferred)(),exit:(0,ae.deferred)(),exitTimeout:(0,ae.deferred)()},u=Promise.race([e===!1?Pr:i.closeTimeout.promise,t===!1?Pr:i.exitTimeout.promise]);return n(e,i.close,i.closeTimeout),n(t,i.exit,i.exitTimeout),{close(a){s=a,i.close.done()},exit(a){s=a,i.exit.done()},get exitCode(){return s},result:u}}function n(s,i,u){s!==!1&&(s===!0?i.promise:i.promise.then(()=>at(s))).then(u.done)}return{type:"spawn.after",action(s,i){return pe(this,arguments,function*(u,{spawned:a,close:g}){var v,l;let f=r(),m=!0,h=()=>void(m=!1);(v=a.stdout)==null||v.on("data",h),(l=a.stderr)==null||l.on("data",h),a.on("error",h),a.on("close",G=>f.close(G)),a.on("exit",G=>f.exit(G));try{yield f.result,m&&(yield at(50)),g(f.exitCode)}catch(G){g(f.exitCode,G)}})}}}Q();function Cu(e){return!!(e.exitCode&&e.stdErr.length)}function xu(e){return Buffer.concat([...e.stdOut,...e.stdErr])}function Su(e=!1,t=Cu,r=xu){return(n,s)=>!e&&n||!t(s)?n:r(s)}function Mr(e){return{type:"task.error",action(t,r){let n=e(t.error,{stdErr:r.stdErr,stdOut:r.stdOut,exitCode:r.exitCode});return Buffer.isBuffer(n)?{error:new z(void 0,n.toString("utf-8"))}:{error:n}}}}y();var Ou=class{constructor(){this.plugins=new Set}add(e){let t=[];return K(e).forEach(r=>r&&this.plugins.add(b(t,r))),()=>{t.forEach(r=>this.plugins.delete(r))}}exec(e,t,r){let n=t,s=Object.freeze(Object.create(r));for(let i of this.plugins)i.type===e&&(n=i.action(n,s));return n}};y();function Eu(e){let t="--progress",r=["checkout","clone","fetch","pull","push"];return[{type:"spawn.args",action(i,u){return r.includes(u.method)?Ur(i,t):i}},{type:"spawn.after",action(i,u){var a;!u.commands.includes(t)||(a=u.spawned.stderr)==null||a.on("data",g=>{let v=/^([\s\S]+?):\s*(\d+)% \((\d+)\/(\d+)\)/.exec(g.toString("utf8"));!v||e({method:u.method,stage:Ru(v[1]),progress:T(v[2]),processed:T(v[3]),total:T(v[4])})})}}]}function Ru(e){return String(e.toLowerCase().split(" ",1))||"unknown"}y();function Au(e){let t=Hr(e,["uid","gid"]);return{type:"spawn.options",action(r){return j(j({},t),r)}}}function Fu({block:e}){if(e>0)return{type:"spawn.after",action(t,r){var n,s;let i;function u(){i&&clearTimeout(i),i=setTimeout(g,e)}function a(){var v,l;(v=r.spawned.stdout)==null||v.off("data",u),(l=r.spawned.stderr)==null||l.off("data",u),r.spawned.off("exit",a),r.spawned.off("close",a),i&&clearTimeout(i)}function g(){a(),r.kill(new yt(void 0,"timeout","block timeout reached"))}(n=r.spawned.stdout)==null||n.on("data",u),(s=r.spawned.stderr)==null||s.on("data",u),r.spawned.on("exit",a),r.spawned.on("close",a),u()}}}y();var Pu=yu();function Mu(e,t){let r=new Ou,n=Kr(e&&(typeof e=="string"?{baseDir:e}:e)||{},t);if(!Tt(n.baseDir))throw new bu(n,"Cannot use simple-git on a directory that does not exist");return Array.isArray(n.config)&&r.add(Tu(n.config)),r.add(wu(n.completion)),n.abort&&r.add(ku(n.abort)),n.progress&&r.add(Eu(n.progress)),n.timeout&&r.add(Fu(n.timeout)),n.spawnOptions&&r.add(Au(n.spawnOptions)),r.add(Mr(Su(!0))),n.errors&&r.add(Mr(n.errors)),new Pu(n,r)}ce();var Ds=Mu;var Is="BREAKING CHANGES",$s="Features",js="Bug Fixes";function zt(e){return e.toLowerCase().replace(/\s/gm,"-")}function Te({options:e}){return e.module?`${zt(e.module)}-v`:"v"}function Ns({prevTag:e,options:t}){return e==null?void 0:e.replace(Te({options:t}),"")}function Bs({prevVersion:e,changes:t}){if(!e)return console.log("No previous tag, using 1.0.0"),"1.0.0";let[r,n,s]=e.split(".").map(Number);return console.log(`Previous version: ${r}.${n}.${s}`),t.breakingChanges.length>0?(r++,n=0,s=0):t.features.length>0?(n++,s=0):t.fixes.length>0&&s++,`${r}.${n}.${s}`}async function Gs({git:e,options:t}){let r=(await e.tags()).all.reverse();console.log("Tags:",r);let n=Te({options:t});console.log(`Finding latest tag that starts with "${n}"`);let s=r.find(i=>i.startsWith(n));return console.log(`Previous tag: ${s}`),s}async function Us({git:e,prevTag:t,options:r}){let n;return t?(console.log("Getting commits since previous tag"),n=await e.log({from:t,to:"HEAD"})):(console.log("Getting all commits"),n=await e.log()),n.all.filter(Lu(r)).reverse()}function Lu(e){let t;if(e.module){let r=e.scopes??[zt(e.module)];t=new RegExp(`^(feat!?|fix)\\((${r.join("|")})\\)`,"m")}else t=new RegExp("^(feat!?|fix)","m");return r=>t.test(r.message)}async function Du(e={},t=Ds()){console.log("Options:",e);let r=await Gs({git:t,options:e}),n=Ns({prevTag:r,options:e}),s=await Us({git:t,prevTag:r,options:e}),i=Iu({commits:s}),u=$u({changes:i,options:e}),a=Bs({prevVersion:n,changes:i}),g=Te({options:e})+a,l={skipped:n===a,changelog:u,prevTag:r,prevVersion:n,nextTag:g,nextVersion:a};return console.log("Results:",l),l}function Iu({commits:e}){let t={fixes:[],features:[],breakingChanges:[]};for(let r of e){if(r.message.startsWith("feat")){let n=ju(r);t.breakingChanges.push(...n)}r.message.startsWith("feat")?t.features.push(r):t.fixes.push(r)}return t}function $u({changes:e,options:t}){let r=[];if(t.prefix&&r.push(t.prefix.trim()),e.features.length>0){let n=t.fixHeading??$s;r.push("",`### ${n}`,"",...e.features.map(Wt))}if(e.fixes.length>0){let n=t.fixHeading??js;r.push("",`### ${n}`,"",...e.fixes.map(Wt))}if(e.breakingChanges.length>0){let n=t.breakingChangeHeading??Is;r.push("",`### ${n}`,"",...e.breakingChanges.map(Wt))}return t.suffix&&r.push(t.suffix.trim()),r.join(`
`).trim()}function Wt(e){let r=/.*\((.*?)\):\s*?(.*)/.exec(e.message);if(r)return`- **${r[1]}:** ${r[2].trim()} (${e.hash})`;let s=/.*?:\s*?(.*)/.exec(e.message);if(s)return`- ${s[1].trim()} (${e.hash})`;throw Error("Could not parse commit: "+e.message)}function ju(e){let t=[];return e.message.includes("!:")&&t.push(e),e.body.split(`
`).forEach(r=>{r.startsWith("BREAKING CHANGE:")&&t.push({message:r,hash:e.hash})}),t}0&&(module.exports={generateChangelog});
